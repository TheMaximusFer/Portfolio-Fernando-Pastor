-- DROP SCHEMA sisinf;

CREATE SCHEMA sisinf AUTHORIZATION postgres;

-- DROP TYPE sisinf."dimension";

CREATE TYPE sisinf."dimension" AS ENUM (
	'overworld',
	'nether',
	'end');

-- DROP TYPE sisinf."plataforma_tipo";

CREATE TYPE sisinf."plataforma_tipo" AS ENUM (
	'java',
	'bedrock');
-- sisinf.report definition

-- Drop table

-- DROP TABLE sisinf.report;

CREATE TABLE sisinf.report (
	report_description text NULL,
	url_context varchar NOT NULL,
	reporter_username varchar NOT NULL,
	reported_username varchar NOT NULL,
	CONSTRAINT denuncia_check CHECK (((reporter_username)::text <> (reported_username)::text)),
	CONSTRAINT denuncia_pk PRIMARY KEY (reporter_username, reported_username)
);


-- sisinf."user" definition

-- Drop table

-- DROP TABLE sisinf."user";

CREATE TABLE sisinf."user" (
	"admin" bool NULL,
	banned bool NULL,
	sanctioned bool NULL,
	end_of_sanction timestamp(6) NULL,
	description varchar(255) NULL,
	email varchar(255) NULL,
	"password" varchar(255) NULL,
	profile_picture_file_path varchar(255) NULL,
	sanction_reason varchar(255) NULL,
	username varchar(255) NOT NULL,
	CONSTRAINT user_pkey PRIMARY KEY (username)
);


-- sisinf.world definition

-- Drop table

-- DROP TABLE sisinf.world;

CREATE TABLE sisinf.world (
	public bool DEFAULT false NOT NULL,
	description text NULL,
	world_name varchar(40) NOT NULL,
	mods bool DEFAULT false NOT NULL,
	world_owner varchar NOT NULL,
	platform sisinf."plataforma_tipo" NOT NULL,
	"version" varchar NOT NULL,
	file_path text NULL,
	miniature_file_path text NULL,
	display_name varchar NOT NULL,
	CONSTRAINT world_pk PRIMARY KEY (world_owner, world_name)
);


-- sisinf.favourites definition

-- Drop table

-- DROP TABLE sisinf.favourites;

CREATE TABLE sisinf.favourites (
	username varchar NOT NULL,
	world_owner varchar NOT NULL,
	world_name varchar NOT NULL,
	CONSTRAINT favoritos_pk PRIMARY KEY (username, world_name, world_owner),
	CONSTRAINT favoritos_world_fk FOREIGN KEY (world_owner,world_name) REFERENCES sisinf.world(world_owner,world_name) ON DELETE CASCADE ON UPDATE CASCADE
);


-- sisinf.marker definition

-- Drop table

-- DROP TABLE sisinf.marker;

CREATE TABLE sisinf.marker (
	x float8 NOT NULL,
	y float8 NOT NULL,
	z float8 NOT NULL,
	id_marker varchar NOT NULL,
	world_owner varchar NOT NULL,
	world_name varchar NOT NULL,
	"dimension" sisinf."dimension" NOT NULL,
	CONSTRAINT marcadores_pk PRIMARY KEY (id_marker, world_name, world_owner),
	CONSTRAINT marcadores_world_fk FOREIGN KEY (world_owner,world_name) REFERENCES sisinf.world(world_owner,world_name) ON DELETE CASCADE ON UPDATE CASCADE
);


-- sisinf.photo definition

-- Drop table

-- DROP TABLE sisinf.photo;

CREATE TABLE sisinf.photo (
	file_path text NOT NULL,
	world_owner varchar NOT NULL,
	world_name varchar NOT NULL,
	CONSTRAINT foto_pk PRIMARY KEY (world_name, world_owner, file_path),
	CONSTRAINT foto_world_fk FOREIGN KEY (world_owner,world_name) REFERENCES sisinf.world(world_owner,world_name) ON DELETE CASCADE ON UPDATE CASCADE
);